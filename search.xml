<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Hello World</title>
    <url>/2022/09/11/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><pre><code class="lang-bash">$ hexo new &quot;My New Post&quot;
</code></pre>
<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><pre><code class="lang-bash">$ hexo server
</code></pre>
<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><pre><code class="lang-bash">$ hexo generate
</code></pre>
<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><pre><code class="lang-bash">$ hexo deploy
</code></pre>
<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
  </entry>
  <entry>
    <title>TS(ä¸€)</title>
    <url>/2022/09/15/test/</url>
    <content><![CDATA[<h1 id="typescriptä¸Javascript"><a href="#typescriptä¸Javascript" class="headerlink" title="typescriptä¸Javascript"></a>typescriptä¸Javascript</h1><p>jsæ˜¯åŠ¨æ€ç±»å‹å¼±ç±»å‹è¯­è¨€ï¼Œè€Œtsæ˜¯é™æ€ç±»å‹å¼±ç±»å‹è¯­è¨€ã€‚<br>å¼ºç±»å‹è¯­è¨€ï¼šä¸å…è®¸æ”¹å˜å˜é‡çš„æ•°æ®ç±»å‹ï¼Œé™¤éè¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚å¦‚python<br>å¼±ç±»å‹è¯­è¨€ï¼šå˜é‡å¯ä»¥è¢«èµ‹äºˆä¸åŒçš„å€¼ã€‚<br>é™æ€ç±»å‹è¯­è¨€ï¼šåœ¨ç¼–è¯‘é˜¶æ®µç¡®å®šæ‰€æœ‰å˜é‡çš„ç±»å‹ã€‚<br>åŠ¨æ€ç±»å‹è¯­è¨€ï¼šåœ¨æ‰§è¡Œé˜¶æ®µç¡®å®šæ‰€æœ‰å˜é‡çš„ç±»å‹ã€‚</p>
<h2 id="tsçš„æ•°æ®ç±»å‹"><a href="#tsçš„æ•°æ®ç±»å‹" class="headerlink" title="tsçš„æ•°æ®ç±»å‹"></a>tsçš„æ•°æ®ç±»å‹</h2><p>tsçš„æ•°æ®ç±»å‹æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯jsåŸæœ‰çš„æ•°æ®ç±»å‹ï¼Œä¸€ç§æ˜¯æ–°å¢çš„æ•°æ®ç±»å‹<br><strong>åŸæœ‰æ•°æ®ç±»å‹</strong><br>åŸå§‹ç±»å‹ï¼šnumber/string/bollean/null/undefined/symbol<br>å¯¹è±¡ç±»å‹ï¼šobjectï¼ˆæ•°ç»„ã€å¯¹è±¡ã€å‡½æ•°ç­‰ï¼‰<br>jså†™æ³•:</p>
<pre><code class="lang-js">let a = &#39;hhh&#39;
let b = 666
let c = true
let d = null
let e = undefined
let f = &#123;name:&#39;maobuhui&#39;&#125;
let g = 100
let h = Symbol()
</code></pre>
<p>tså†™æ³•:</p>
<pre><code class="lang-ts">let a:string = &#39;hhh&#39;
let b:number = 666
let c:boolean = true
let d:null = null
let e:undefined = undefined
let f:object = &#123;name:&#39;maobuhui&#39;&#125;
let g:bigint = 100n
let h:symbol = Symbol()
</code></pre>
<p><strong>æ–°å¢ç±»å‹</strong></p>
<ol>
<li>è”åˆç±»å‹</li>
<li>è‡ªå®šä¹‰ç±»å‹(ç±»å‹åˆ«å)</li>
<li>æ¥å£</li>
<li>å…ƒç»„</li>
<li>å­—é¢é‡ç±»å‹</li>
<li>æšä¸¾</li>
<li>void</li>
<li>any<br>å¯¹è±¡ç±»å‹(æ¥å£ interface)<br>```js<br>interface IByteDancer{<br> /<em>åªè¯»å±æ€§ï¼šçº¦æŸå±æ€§ä¸å¯åœ¨å¯¹è±¡åˆå§‹åŒ–å¤–èµ‹å€¼</em>/<br> readonly jobId:number;<br> name:string;<br> sex:â€™manâ€™|â€™womanâ€™|â€™otherâ€™;<br> age:number;<br> /<em>å¯é€‰å±æ€§ï¼šå®šä¹‰è¯¥å±æ€§å¯ä»¥ä¸å­˜åœ¨</em>/<br> hobby?:string;<br> /<em>ä»»æ„å±æ€§ï¼šçº¦æŸæ‰€æœ‰å¯¹è±¡å±æ€§å¿…é¡»æ˜¯è¯¥å±æ€§çš„å­ç±»å‹</em>/</li>
</ol>
<pre><code>[key:string]:any;
</code></pre><p>}<br>const bytedancer: IBytedancer = {<br>    jobId:9303245,<br>    name: â€˜linâ€™,<br>    sex: â€˜manâ€™,<br>    age: 28,<br>    hobby: â€˜swimmingâ€™<br>}</p>
<pre><code>å‡½æ•°ç±»å‹
```ts
function add(x:number,y:number):number&#123;
    return x+y;
&#125;
const mult:(x:number,y:number) =&gt; number = (x,y) =&gt; x*y;
</code></pre><p>å‡½æ•°é‡è½½</p>
<pre><code class="lang-ts">/*å¯¹getDateå‡½æ•°è¿›è¡Œé‡è½½ï¼Œtimestampä¸ºå¯ç¼ºçœå‚æ•°*/
function getDate(type:&#39;string&#39;, timestamp?: string) :string;
function getDate (type:&#39;date&#39; ,timestamp?: string): Date;
function getDate(type: &#39;string&#39; | &#39;date&#39;, timestamp?: string): Date | string &#123;
const date = new Date(timestamp); 
return type === &#39;string&#39; ? date.toLocaleString() : date;
&#125;
const X = getDate( &#39;date&#39;); // x: Date
const y = getDate(&#39;string&#39;, &#39;2018-01-10&#39;); // y: string

interface IGetDate &#123;
(type :&#39;string&#39;, timestamp?: string): string;
(type :&#39;date&#39; , timestamp?: string): Date ;
(type : &#39;string&#39; | &#39;date&#39;,timestamp?: string): Date | string; 
&#125;
/*ä¸èƒ½å°†ç±»å‹â€œ(type:any, timestamp: any) =&gt; string | Date&quot; åˆ†é…ç»™ç±»å‹&quot;IGetDate&quot;ã€‚
ä¸èƒ½å°†ç±»å‹&quot;string | Date&quot; åˆ†é…ç»™ç±»å‹&quot;string&quot;ã€‚
ä¸èƒ½å°†ç±»å‹&quot;Date&quot;åˆ†é…ç»™ç±»å‹&quot;string&quot;ã€‚ts (2322) */
const getDate2: IGetDate = (type, timestamp) =&gt; &#123;
const date = new Date( timestamp ) ;
return type === &#39;string&#39; ? date. toLocaleString() : date;
&#125;
</code></pre>
<p>æ•°ç»„ç±»å‹</p>
<pre><code class="lang-ts">/*
ã€Œç±»å‹+æ–¹æ‹¬å·ã€è¡¨ç¤º*/
type IArr1 = number[];
/*æ³›å‹è¡¨ç¤º */
type IArr2 = Array&lt;string|number| Record&lt;string, number&gt;&gt;;
/*å…ƒç¥–è¡¨ç¤º*/
type IArr3 = [number, number, string, string] ;
/*æ¥å£è¡¨ç¤º*/
interface IArr4 &#123;
[key: number]: any;
&#125;
const arr1: IArr1 = [1 , 2, 3, 4, 5, 6];
const arr2: IArr2 = [1 , 2, &#39;3&#39;, &#39;4&#39;,&#123;a:1&#125;];
const arr3: IArr3 = [1, 2, &#39;3&#39;, &#39;4&#39;];
const arr4: IArr4 = [&#39;string&#39;, () =&gt; null, &#123;&#125;, []];
</code></pre>
<p>tsè¡¥å……ç±»å‹</p>
<pre><code class="lang-ts">/*ç©ºç±»å‹ï¼Œè¡¨ç¤ºæ— èµ‹å€¼*/
type IEmptyFunction = () =&gt; void;
/*ä»»æ„ç±»å‹ï¼Œæ˜¯æ‰€æœ‰ç±»å‹çš„å­ç±»å‹*/ 
type IAnyType = any ;
/*æšä¸¾ç±»å‹:æ”¯æŒæšä¸¾å€¼åˆ°æšä¸¾åçš„æ­£ã€åå‘æ˜ å°„*/
enum EnumExample &#123;
    add = &#39;+&#39;,
    mult = &#39;*&#39;
&#125;
EnumExample[&#39;add&#39;] === &#39;+&#39;;
EnumExample[&#39;+&#39;] === &#39;add&#39; ;
enum ECorlor &#123; Mon, Tue, Wed, Thu, Fri, Sat, Sun &#125;;
ECorlor[&#39;Mon&#39;] === 0;
ECorlor[0] === &#39;Mon&#39; ;
/*æ³›å‹*/
type INumArr = Array&lt;number&gt;;
</code></pre>
]]></content>
  </entry>
  <entry>
    <title>ç¥ç»ç½‘ç»œå…¥é—¨1</title>
    <url>/2023/06/03/networkbase1/</url>
    <content><![CDATA[<p>åŸæ–‡å‡ºå¤„<a href="https://victorzhou.com/blog/intro-to-neural-networks/">Machine Learning for Beginners: An Introduction to Neural Networks</a></p>
<h4 id="ç –å—ï¼šç¥ç»å…ƒ"><a href="#ç –å—ï¼šç¥ç»å…ƒ" class="headerlink" title="ç –å—ï¼šç¥ç»å…ƒ"></a>ç –å—ï¼šç¥ç»å…ƒ</h4><p>ç¥ç»ç½‘ç»œçš„åŸºæœ¬å•ä½ï¼Œç¥ç»å…ƒã€‚ç¥ç»å…ƒæ¥å—è¾“å…¥ï¼Œå¯¹å…¶åšä¸€äº›æ•°æ®æ“ä½œï¼Œç„¶åäº§ç”Ÿè¾“å‡ºã€‚ä¾‹å¦‚ï¼Œè¿™æ˜¯ä¸€ä¸ª2-è¾“å…¥ç¥ç»å…ƒï¼š<br><img src="/.io//perceptron.svg" alt><br><img src="/.io//img/perceptron.svg" alt><br>è¿™é‡Œå‘ç”Ÿäº†ä¸‰ä¸ªäº‹æƒ…ã€‚é¦–å…ˆï¼Œæ¯ä¸ªè¾“å…¥éƒ½è·Ÿä¸€ä¸ªæƒé‡ç›¸ä¹˜ï¼ˆçº¢è‰²ï¼‰ï¼š</p>
<script type="math/tex; mode=display">
x_1â†’x_1*w_1 \\
x_2â†’x_2*w_2</script><p>ç„¶åï¼ŒåŠ æƒåçš„è¾“å…¥æ±‚å’Œï¼ŒåŠ ä¸Šä¸€ä¸ªåå·®bï¼ˆç»¿è‰²ï¼‰ï¼š</p>
<script type="math/tex; mode=display">
(x_1*w_1)+(x_2*w_2)+b</script><p>æœ€åï¼Œè¿™ä¸ªç»“æœä¼ é€’ç»™ä¸€ä¸ªæ¿€æ´»å‡½æ•°fï¼š</p>
<script type="math/tex; mode=display">
y=f(x_1*w_1+x_2*w_2+b)</script><p>æ¿€æ´»å‡½æ•°çš„ç”¨é€”æ˜¯å°†ä¸€ä¸ªæ— è¾¹ç•Œçš„è¾“å…¥ï¼Œè½¬å˜æˆä¸€ä¸ªå¯é¢„æµ‹çš„å½¢å¼ã€‚å¸¸ç”¨çš„æ¿€æ´»å‡½æ•°å°±å°±æ˜¯Så‹å‡½æ•°ï¼š<br><img src="/.io//sigmoid.webp" alt><br>Så‹å‡½æ•°çš„å€¼åŸŸæ˜¯$(0, 1)$ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯æŠŠ$(âˆ’âˆ, +âˆ)$å‹ç¼©åˆ°$(0, 1)$ ï¼Œå¾ˆå¤§çš„è´Ÿæ•°çº¦ç­‰äº$0$ï¼Œå¾ˆå¤§çš„æ­£æ•°çº¦ç­‰äº$1$ã€‚</p>
<h4 id="ä¸€ä¸ªç®€å•çš„ä¾‹å­"><a href="#ä¸€ä¸ªç®€å•çš„ä¾‹å­" class="headerlink" title="ä¸€ä¸ªç®€å•çš„ä¾‹å­"></a>ä¸€ä¸ªç®€å•çš„ä¾‹å­</h4><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª2-è¾“å…¥ç¥ç»å…ƒï¼Œæ¿€æ´»å‡½æ•°å°±æ˜¯Så‹å‡½æ•°ï¼Œå…¶å‚æ•°å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
w=[0,1] \\
b=4</script><p>$w=[0,1]$å°±æ˜¯ä»¥å‘é‡çš„å½¢å¼è¡¨ç¤º$w_1=0, w_2=1$ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬ç»™è¿™ä¸ªç¥ç»å…ƒä¸€ä¸ªè¾“å…¥$x=[2, 3]$ã€‚æˆ‘ä»¬ç”¨ç‚¹ç§¯æ¥è¡¨ç¤ºï¼š</p>
<p><img src="/.io//l1.png" alt></p>
<p>å½“è¾“å…¥æ˜¯[2, 3]æ—¶ï¼Œè¿™ä¸ªç¥ç»å…ƒçš„è¾“å‡ºæ˜¯0.999ã€‚ç»™å®šè¾“å…¥ï¼Œå¾—åˆ°è¾“å‡ºçš„è¿‡ç¨‹è¢«ç§°ä¸ºå‰é¦ˆï¼ˆfeedforwardï¼‰ã€‚</p>
<h4 id="ç¼–ç ä¸€ä¸ªç¥ç»å…ƒ"><a href="#ç¼–ç ä¸€ä¸ªç¥ç»å…ƒ" class="headerlink" title="ç¼–ç ä¸€ä¸ªç¥ç»å…ƒ"></a>ç¼–ç ä¸€ä¸ªç¥ç»å…ƒ</h4><p>è®©æˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªç¥ç»å…ƒï¼ç”¨Pythonçš„NumPyåº“æ¥å®Œæˆå…¶ä¸­çš„æ•°å­¦è®¡ç®—ï¼š</p>
<pre><code class="lang-py">import numpy as np

def sigmoid(x):
  # Our activation function: f(x) = 1 / (1 + e^(-x))
  return 1 / (1 + np.exp(-x))

class Neuron:
  def __init__(self, weights, bias):
    self.weights = weights
    self.bias = bias

  def feedforward(self, inputs):
    # Weight inputs, add bias, then use the activation function
    total = np.dot(self.weights, inputs) + self.bias
    return sigmoid(total)

weights = np.array([0, 1]) # w1 = 0, w2 = 1
bias = 4                   # b = 4
n = Neuron(weights, bias)

x = np.array([2, 3])       # x1 = 2, x2 = 3
print(n.feedforward(x))    # 0.9990889488055994
</code></pre>
<p>è¿˜è®°å¾—è¿™ä¸ªæ•°å­—å—ï¼Ÿå°±æ˜¯æˆ‘ä»¬å‰é¢ç®—å‡ºæ¥çš„ä¾‹å­ä¸­çš„0.999ã€‚</p>
<h3 id="æŠŠç¥ç»å…ƒç»„è£…æˆç½‘ç»œ"><a href="#æŠŠç¥ç»å…ƒç»„è£…æˆç½‘ç»œ" class="headerlink" title="æŠŠç¥ç»å…ƒç»„è£…æˆç½‘ç»œ"></a>æŠŠç¥ç»å…ƒç»„è£…æˆç½‘ç»œ</h3><p>æ‰€è°“çš„ç¥ç»ç½‘ç»œå°±æ˜¯ä¸€å †ç¥ç»å…ƒã€‚è¿™å°±æ˜¯ä¸€ä¸ªç®€å•çš„ç¥ç»ç½‘ç»œï¼š<br><img src="/.io//network.svg" alt><br>è¿™ä¸ªç½‘ç»œæœ‰ä¸¤ä¸ªè¾“å…¥ï¼Œä¸€ä¸ªæœ‰ä¸¤ä¸ªç¥ç»å…ƒï¼ˆ$h_1$å’Œ$h_2$ï¼‰çš„éšè—å±‚ï¼Œä»¥åŠä¸€ä¸ªæœ‰ä¸€ä¸ªç¥ç»å…ƒï¼ˆ$o_1$ï¼‰çš„è¾“å‡ºå±‚ã€‚è¦æ³¨æ„,$o_1$çš„è¾“å…¥å°±æ˜¯ $h_1$å’Œ $h_2$çš„è¾“å‡ºï¼Œè¿™æ ·å°±ç»„æˆäº†ä¸€ä¸ªç½‘ç»œã€‚</p>
<blockquote>
<p>éšè—å±‚å°±æ˜¯è¾“å…¥å±‚å’Œè¾“å‡ºå±‚ä¹‹é—´çš„å±‚ï¼Œéšè—å±‚å¯ä»¥æ˜¯å¤šå±‚çš„ã€‚</p>
</blockquote>
<h4 id="ä¾‹å­ï¼šå‰é¦ˆ"><a href="#ä¾‹å­ï¼šå‰é¦ˆ" class="headerlink" title="ä¾‹å­ï¼šå‰é¦ˆ"></a>ä¾‹å­ï¼šå‰é¦ˆ</h4><p>æˆ‘ä»¬ç»§ç»­ç”¨å‰é¢å›¾ä¸­çš„ç½‘ç»œï¼Œå‡è®¾æ¯ä¸ªç¥ç»å…ƒçš„æƒé‡éƒ½æ˜¯$w=[0,1]$ ï¼Œæˆªè·é¡¹ä¹Ÿç›¸åŒ $b=0$ï¼Œæ¿€æ´»å‡½æ•°ä¹Ÿéƒ½æ˜¯Så‹å‡½æ•°ã€‚åˆ†åˆ«ç”¨<br> $h_1,h_2,o_1$è¡¨ç¤ºç›¸åº”çš„ç¥ç»å…ƒçš„è¾“å‡ºã€‚</p>
<p>å½“è¾“å…¥$x=[2,3]$æ—¶ï¼Œä¼šå¾—åˆ°ä»€ä¹ˆç»“æœï¼Ÿ<br><img src="/.io//l2.png" alt><br>è¿™ä¸ªç¥ç»ç½‘ç»œå¯¹è¾“å…¥[2,3]çš„è¾“å‡ºæ˜¯0.7216ï¼Œå¾ˆç®€å•ã€‚</p>
<p>ä¸€ä¸ªç¥ç»ç½‘ç»œçš„å±‚æ•°ä»¥åŠæ¯ä¸€å±‚ä¸­çš„ç¥ç»å…ƒæ•°é‡éƒ½æ˜¯ä»»æ„çš„ã€‚åŸºæœ¬é€»è¾‘éƒ½ä¸€æ ·ï¼šè¾“å…¥åœ¨ç¥ç»ç½‘ç»œä¸­å‘å‰ä¼ è¾“ï¼Œæœ€ç»ˆå¾—åˆ°è¾“å‡ºã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¼šç»§ç»­ä½¿ç”¨å‰é¢çš„è¿™ä¸ªç½‘ç»œã€‚</p>
<h4 id="ç¼–ç ç¥ç»ç½‘ç»œï¼šå‰é¦ˆ"><a href="#ç¼–ç ç¥ç»ç½‘ç»œï¼šå‰é¦ˆ" class="headerlink" title="ç¼–ç ç¥ç»ç½‘ç»œï¼šå‰é¦ˆ"></a>ç¼–ç ç¥ç»ç½‘ç»œï¼šå‰é¦ˆ</h4><p>æ¥ä¸‹æ¥æˆ‘ä»¬å®ç°è¿™ä¸ªç¥ç»ç½‘ç»œçš„å‰é¦ˆæœºåˆ¶ï¼Œè¿˜æ˜¯è¿™ä¸ªå›¾ï¼š<br><img src="/.io//network%20(1" alt>.svg)</p>
<pre><code class="lang-py">import numpy as np

# ... code from previous section here

class OurNeuralNetwork:
  &#39;&#39;&#39;
  A neural network with:
    - 2 inputs
    - a hidden layer with 2 neurons (h1, h2)
    - an output layer with 1 neuron (o1)
  Each neuron has the same weights and bias:
    - w = [0, 1]
    - b = 0
  &#39;&#39;&#39;
  def __init__(self):
    weights = np.array([0, 1])
    bias = 0

    # The Neuron class here is from the previous section
    self.h1 = Neuron(weights, bias)
    self.h2 = Neuron(weights, bias)
    self.o1 = Neuron(weights, bias)

  def feedforward(self, x):
    out_h1 = self.h1.feedforward(x)
    out_h2 = self.h2.feedforward(x)

    # The inputs for o1 are the outputs from h1 and h2
    out_o1 = self.o1.feedforward(np.array([out_h1, out_h2]))

    return out_o1

network = OurNeuralNetwork()
x = np.array([2, 3])
print(network.feedforward(x)) # 0.7216325609518421
</code></pre>
<p>We got 0.7216 again! Looks like it works.</p>
<h3 id="è®­ç»ƒç¥ç»ç½‘ç»œï¼Œç¬¬1éƒ¨åˆ†"><a href="#è®­ç»ƒç¥ç»ç½‘ç»œï¼Œç¬¬1éƒ¨åˆ†" class="headerlink" title="è®­ç»ƒç¥ç»ç½‘ç»œï¼Œç¬¬1éƒ¨åˆ†"></a>è®­ç»ƒç¥ç»ç½‘ç»œï¼Œç¬¬1éƒ¨åˆ†</h3><p>ç°åœ¨æœ‰è¿™æ ·çš„æ•°æ®ï¼š<br>|Name     |Weight(lb)|    Height(in)    |Gender|<br>|  â€”â€”| â€”â€”  |â€”â€”|â€”â€”|<br>|Alice |133       |    65          |    F    |<br>|Bob     |160          |72             |M     |<br>|Charlie|    152|    70|    M|<br>|Diana    |120    |60    |F|<br>æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨è¿™ä¸ªæ•°æ®æ¥è®­ç»ƒç¥ç»ç½‘ç»œçš„æƒé‡å’Œæˆªè·é¡¹ï¼Œä»è€Œå¯ä»¥æ ¹æ®èº«é«˜ä½“é‡é¢„æµ‹æ€§åˆ«ï¼š<br><img src="/.io//network2.svg" alt><br>æˆ‘ä»¬ç”¨0å’Œ1åˆ†åˆ«è¡¨ç¤ºç”·æ€§ï¼ˆMï¼‰å’Œå¥³æ€§ï¼ˆFï¼‰ï¼Œå¹¶å¯¹æ•°å€¼åšäº†è½¬åŒ–ï¼š<br>|Name    |Weight(minus 135)    |Height(minus 66)    |Gender|<br>|  â€”â€”| â€”â€”  |â€”â€”|â€”â€”|<br>|Alice    |-2    |-1    |1|<br>|Bob    |25|    6    |0|<br>|Charlie|    17    |4|    0|<br>|Diana    |-15|    -6|    1|</p>
<blockquote>
<p>æˆ‘è¿™é‡Œæ˜¯éšæ„é€‰å–äº†135å’Œ66æ¥æ ‡å‡†åŒ–æ•°æ®ï¼Œé€šå¸¸ä¼šä½¿ç”¨å¹³å‡å€¼ã€‚</p>
</blockquote>
<h4 id="æŸå¤±"><a href="#æŸå¤±" class="headerlink" title="æŸå¤±"></a>æŸå¤±</h4><p>åœ¨è®­ç»ƒç½‘ç»œä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦é‡åŒ–å½“å‰çš„ç½‘ç»œæ˜¯ã€å¥½ã€è¿˜æ˜¯ã€åã€ï¼Œä»è€Œå¯ä»¥å¯»æ‰¾æ›´å¥½çš„ç½‘ç»œã€‚è¿™å°±æ˜¯å®šä¹‰<strong>æŸå¤±</strong>çš„ç›®çš„ã€‚</p>
<p>æˆ‘ä»¬åœ¨è¿™é‡Œç”¨å¹³å‡æ–¹å·®ï¼ˆMSEï¼‰æŸå¤±ï¼š<br>$MSE=\frac{1}{n}\sum_{i=1}^{n} (y_{true}-y_{pred})^2$<br> è®©æˆ‘ä»¬ä»”ç»†çœ‹çœ‹ï¼š</p>
<ul>
<li>næ˜¯æ ·å“æ•°ï¼Œè¿™é‡Œç­‰äº4ï¼ˆAliceã€Bobã€Charlieå’ŒDianaï¼‰ã€‚</li>
<li>yè¡¨ç¤ºè¦é¢„æµ‹çš„å˜é‡ï¼Œè¿™é‡Œæ˜¯æ€§åˆ«ã€‚</li>
<li>$y_{true}$ æ˜¯å˜é‡çš„çœŸå®å€¼ï¼ˆã€æ­£ç¡®ç­”æ¡ˆã€ï¼‰ã€‚ä¾‹å¦‚ï¼ŒAliceçš„$y_{true}$ å°±æ˜¯1ï¼ˆç”·æ€§ï¼‰ã€‚</li>
<li>$y_{pred}$ æ˜¯å˜é‡çš„é¢„æµ‹å€¼ã€‚è¿™å°±æ˜¯æˆ‘ä»¬ç½‘ç»œçš„è¾“å‡ºã€‚</li>
</ul>
<p>$(y_{true}-y_{pred})^2$è¢«ç§°ä¸ºæ–¹å·®ï¼ˆsquared errorï¼‰ã€‚æˆ‘ä»¬çš„æŸå¤±å‡½æ•°å°±æ˜¯æ‰€æœ‰æ–¹å·®çš„å¹³å‡å€¼ã€‚é¢„æµ‹æ•ˆæœäºæµ©ï¼ŒæŸå¤±å°±è¶Šå°‘ã€‚<br>æ›´å¥½çš„é¢„æµ‹ = æ›´å°‘çš„æŸå¤±ï¼<br>è®­ç»ƒç½‘ç»œ = æœ€å°åŒ–å®ƒçš„æŸå¤±ã€‚</p>
<h4 id="æŸå¤±è®¡ç®—ä¾‹å­"><a href="#æŸå¤±è®¡ç®—ä¾‹å­" class="headerlink" title="æŸå¤±è®¡ç®—ä¾‹å­"></a>æŸå¤±è®¡ç®—ä¾‹å­</h4><p>å‡è®¾æˆ‘ä»¬çš„ç½‘ç»œæ€»æ˜¯è¾“å‡º0ï¼Œæ¢è¨€ä¹‹å°±æ˜¯è®¤ä¸ºæ‰€æœ‰äººéƒ½æ˜¯ç”·æ€§ã€‚æŸå¤±å¦‚ä½•ï¼ŸğŸ¤”<br><img src="/.io//l3.png" alt></p>
<h4 id="ä»£ç ï¼šMSEæŸå¤±"><a href="#ä»£ç ï¼šMSEæŸå¤±" class="headerlink" title="ä»£ç ï¼šMSEæŸå¤±"></a>ä»£ç ï¼šMSEæŸå¤±</h4><p>ä¸‹é¢æ˜¯è®¡ç®—MSEæŸå¤±çš„ä»£ç ï¼š</p>
<pre><code class="lang-py">import numpy as np

def mse_loss(y_true, y_pred):
  # y_true and y_pred are numpy arrays of the same length.
  return ((y_true - y_pred) ** 2).mean()

y_true = np.array([1, 0, 0, 1])
y_pred = np.array([0, 0, 0, 0])

print(mse_loss(y_true, y_pred)) # 0.5
</code></pre>
<blockquote>
<p>å¦‚æœä½ ä¸ç†è§£è¿™æ®µä»£ç ï¼Œå¯ä»¥çœ‹çœ‹NumPyçš„<a href="https://numpy.org/doc/stable/user/quickstart.html#basic-operations">å¿«é€Ÿå…¥é—¨</a>ä¸­å…³äºæ•°ç»„çš„æ“ä½œã€‚</p>
</blockquote>
<p>Nice. Onwards!</p>
<h3 id="è®­ç»ƒç¥ç»ç½‘ç»œï¼Œç¬¬2éƒ¨åˆ†"><a href="#è®­ç»ƒç¥ç»ç½‘ç»œï¼Œç¬¬2éƒ¨åˆ†" class="headerlink" title="è®­ç»ƒç¥ç»ç½‘ç»œï¼Œç¬¬2éƒ¨åˆ†"></a>è®­ç»ƒç¥ç»ç½‘ç»œï¼Œç¬¬2éƒ¨åˆ†</h3><p>ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªæ˜ç¡®çš„ç›®æ ‡ï¼šæœ€å°åŒ–ç¥ç»ç½‘ç»œçš„æŸå¤±ã€‚é€šè¿‡è°ƒæ•´ç½‘ç»œçš„æƒé‡å’Œæˆªè·é¡¹ï¼Œæˆ‘ä»¬å¯ä»¥æ”¹å˜å…¶é¢„æµ‹ç»“æœï¼Œä½†å¦‚ä½•æ‰èƒ½é€æ­¥åœ°å‡å°‘æŸå¤±ï¼Ÿ</p>
<blockquote>
<p>è¿™ä¸€æ®µå†…å®¹æ¶‰åŠåˆ°å¤šå…ƒå¾®ç§¯åˆ†ï¼Œå¦‚æœä¸ç†Ÿæ‚‰å¾®ç§¯åˆ†çš„è¯ï¼Œå¯ä»¥è·³è¿‡è¿™äº›æ•°å­¦å†…å®¹ã€‚</p>
</blockquote>
<p>ä¸ºäº†ç®€åŒ–é—®é¢˜ï¼Œå‡è®¾æˆ‘ä»¬çš„æ•°æ®é›†ä¸­åªæœ‰Aliceï¼š<br>|Name    |Weight(minus 135)    |Height(minus 66)    |Gender|<br>|  â€”â€”| â€”â€”  |â€”â€”|â€”â€”|<br>|Alice    |-2    |-1|    1|<br>|Name    |$y_{true}$    |$y_{pred}$    |$(y_{true}-y_{pred})^2$|<br>|Alice    |1    |0|    1|</p>
<p>é‚£å‡æ–¹å·®æŸå¤±å°±åªæ˜¯Aliceçš„æ–¹å·®ï¼š<br>$MSE=\frac{1}{1}\sum_{i=1}^{1} (y_{true}-y_{pred})^2 \\<br>\quad \quad= (y_{true}-y_{pred})^2 \\<br>\quad \quad= (1-y_{pred})^2$<br>ä¹Ÿå¯ä»¥æŠŠæŸå¤±çœ‹æˆæ˜¯æƒé‡å’Œæˆªè·é¡¹çš„å‡½æ•°ã€‚è®©æˆ‘ä»¬ç»™ç½‘ç»œæ ‡ä¸Šæƒé‡å’Œæˆªè·é¡¹ï¼š<br><img src="/.io//network3%20(1" alt>.svg)<br>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æŠŠç½‘ç»œçš„æŸå¤±è¡¨ç¤ºä¸ºï¼š</p>
<script type="math/tex; mode=display">L(w_1,w_2,w_3,w_4,w_5,w_6,b_1,b_2,b_3)</script><p>å‡è®¾æˆ‘ä»¬è¦ä¼˜åŒ– $w_1$ï¼Œå½“æˆ‘ä»¬æ”¹å˜$w_1$æ—¶ï¼ŒæŸå¤± $L$ ä¼šæ€ä¹ˆå˜åŒ–ï¼Ÿå¯ä»¥ç”¨ $ \frac{\partial L}{\partial w_1}$æ¥å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæ€ä¹ˆè®¡ç®—ï¼Ÿ</p>
<blockquote>
<p>æ¥ä¸‹æ¥çš„æ•°æ®ç¨å¾®æœ‰ç‚¹å¤æ‚ï¼Œåˆ«æ‹…å¿ƒï¼Œå‡†å¤‡å¥½çº¸å’Œç¬”ã€‚</p>
</blockquote>
<p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬ç”¨ $ \frac{\partial y_{pred}}{\partial w_1}$æ¥æ”¹å†™è¿™ä¸ªåå¯¼æ•°ï¼š<br><img src="/.io//l4.png" alt><br><img src="/.io//l5.png" alt><br>è¿™ç§è®¡ç®—åå¯¼çš„æ–¹æ³•å«ã€åå‘ä¼ æ’­ç®—æ³•ã€(backpropagation)ã€‚</p>
<p>å¥½å¤šæ•°å­¦ç¬¦å·ï¼Œå¦‚æœä½ è¿˜æ²¡ææ˜ç™½çš„è¯ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå®é™…ä¾‹å­ã€‚</p>
<h4 id="ä¾‹å­ï¼šè®¡ç®—åå¯¼æ•°"><a href="#ä¾‹å­ï¼šè®¡ç®—åå¯¼æ•°" class="headerlink" title="ä¾‹å­ï¼šè®¡ç®—åå¯¼æ•°"></a>ä¾‹å­ï¼šè®¡ç®—åå¯¼æ•°</h4><p>æˆ‘ä»¬è¿˜æ˜¯çœ‹æ•°æ®é›†ä¸­åªæœ‰Aliceçš„æƒ…å†µ:<br>|Name    |Weight(minus 135)    |Height(minus 66)    |Gender|<br>|  â€”â€”| â€”â€”  |â€”â€”|â€”â€”|<br>|Alice    |-2    |-1|    1|<br>|Name    |$y_{true}$    |$y_{pred}$    |$(y_{true}-y_{pred})^2$|<br>|Alice    |1    |0|    1|<br>æŠŠæ‰€æœ‰çš„æƒé‡å’Œæˆªè·é¡¹éƒ½åˆ†åˆ«åˆå§‹åŒ–ä¸º1å’Œ0ã€‚åœ¨ç½‘ç»œä¸­åšå‰é¦ˆè®¡ç®—ï¼š<br><img src="/.io//l6.png" alt><br><img src="/.io//l7.png" alt></p>
<h4 id="è®­ç»ƒï¼šéšæœºæ¢¯åº¦ä¸‹é™"><a href="#è®­ç»ƒï¼šéšæœºæ¢¯åº¦ä¸‹é™" class="headerlink" title="è®­ç»ƒï¼šéšæœºæ¢¯åº¦ä¸‹é™"></a>è®­ç»ƒï¼šéšæœºæ¢¯åº¦ä¸‹é™</h4><p>ç°åœ¨è®­ç»ƒç¥ç»ç½‘ç»œå·²ç»ä¸‡äº‹ä¿±å¤‡äº†ï¼æˆ‘ä»¬ä¼šä½¿ç”¨åä¸ºéšæœºæ¢¯åº¦ä¸‹é™æ³•çš„ä¼˜åŒ–ç®—æ³•æ¥ä¼˜åŒ–ç½‘ç»œçš„æƒé‡å’Œæˆªè·é¡¹ï¼Œå®ç°æŸå¤±çš„æœ€å°åŒ–ã€‚æ ¸å¿ƒå°±æ˜¯è¿™ä¸ªæ›´æ–°ç­‰å¼ï¼š</p>
<script type="math/tex; mode=display">w_1â†w_1-Î·\frac{\partial L}{\partial w_1}</script><p> Î·æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œè¢«ç§°ä¸ºå­¦ä¹ ç‡ï¼Œç”¨äºè°ƒæ•´è®­ç»ƒçš„é€Ÿåº¦ã€‚æˆ‘ä»¬è¦åšçš„å°±æ˜¯ç”¨$w_1$ å‡å»$Î·\frac{\partial L}{\partial w_1}$ ï¼š</p>
<ul>
<li>å¦‚æœ $\frac{\partial L}{\partial w_1}$æ˜¯æ­£æ•°ï¼Œ$w_1$ ä¼šå˜å°ï¼Œ$L$ ä¼šä¸‹é™ã€‚</li>
<li>å¦‚æœ $\frac{\partial L}{\partial w_1}$æ˜¯è´Ÿæ•°ï¼Œ$w_1$ ä¼šå˜å¤§ï¼Œ$L$ ä¼šä¸‹é™ã€‚<br>å¦‚æœæˆ‘ä»¬å¯¹ç½‘ç»œä¸­çš„æ¯ä¸ªæƒé‡å’Œæˆªè·é¡¹éƒ½è¿™æ ·è¿›è¡Œä¼˜åŒ–ï¼ŒæŸå¤±å°±ä¼šä¸æ–­ä¸‹é™ï¼Œç½‘ç»œæ€§èƒ½ä¼šä¸æ–­ä¸Šå‡ã€‚</li>
</ul>
<p>æˆ‘ä»¬çš„è®­ç»ƒè¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼š</p>
<ol>
<li>ä»æˆ‘ä»¬çš„æ•°æ®é›†ä¸­é€‰æ‹©ä¸€ä¸ªæ ·æœ¬ï¼Œç”¨éšæœºæ¢¯åº¦ä¸‹é™æ³•è¿›è¡Œä¼˜åŒ–â€”â€”æ¯æ¬¡æˆ‘ä»¬éƒ½åªé’ˆå¯¹ä¸€ä¸ªæ ·æœ¬è¿›è¡Œä¼˜åŒ–ï¼› </li>
<li>è®¡ç®—æ¯ä¸ªæƒé‡æˆ–æˆªè·é¡¹å¯¹æŸå¤±çš„åå¯¼ï¼ˆä¾‹å¦‚ $\frac{\partial L}{\partial w_1}$ ã€ $\frac{\partial L}{\partial w_2}$ ç­‰ï¼‰ï¼› </li>
<li>ç”¨æ›´æ–°ç­‰å¼æ›´æ–°æ¯ä¸ªæƒé‡å’Œæˆªè·é¡¹ï¼› </li>
<li>é‡å¤ç¬¬ä¸€æ­¥ï¼›</li>
</ol>
<h3 id="ä»£ç ï¼šä¸€ä¸ªå®Œæ•´çš„ç¥ç»ç½‘ç»œ"><a href="#ä»£ç ï¼šä¸€ä¸ªå®Œæ•´çš„ç¥ç»ç½‘ç»œ" class="headerlink" title="ä»£ç ï¼šä¸€ä¸ªå®Œæ•´çš„ç¥ç»ç½‘ç»œ"></a>ä»£ç ï¼šä¸€ä¸ªå®Œæ•´çš„ç¥ç»ç½‘ç»œ</h3><p>æˆ‘ä»¬ç»ˆäºå¯ä»¥å®ç°ä¸€ä¸ªå®Œæ•´çš„ç¥ç»ç½‘ç»œäº†ï¼š<br>|Name    |Weight(minus 135)    |Height(minus 66)    |Gender|<br>|  â€”â€”| â€”â€”  |â€”â€”|â€”â€”|<br>|Alice    |-2    |-1    |1|<br>|Bob    |25|    6    |0|<br>|Charlie|    17    |4|    0|<br>|Diana    |-15|    -6|    1|<br><img src="/.io//network3%20(1" alt>.svg)</p>
<pre><code class="lang-py">import numpy as np

def sigmoid(x):
  # Sigmoid activation function: f(x) = 1 / (1 + e^(-x))
  return 1 / (1 + np.exp(-x))

def deriv_sigmoid(x):
  # Derivative of sigmoid: f&#39;(x) = f(x) * (1 - f(x))
  fx = sigmoid(x)
  return fx * (1 - fx)

def mse_loss(y_true, y_pred):
  # y_true and y_pred are numpy arrays of the same length.
  return ((y_true - y_pred) ** 2).mean()

class OurNeuralNetwork:
  &#39;&#39;&#39;
  A neural network with:
    - 2 inputs
    - a hidden layer with 2 neurons (h1, h2)
    - an output layer with 1 neuron (o1)

  *** DISCLAIMER ***:
  The code below is intended to be simple and educational, NOT optimal.
  Real neural net code looks nothing like this. DO NOT use this code.
  Instead, read/run it to understand how this specific network works.
  &#39;&#39;&#39;
  def __init__(self):
    # Weights
    self.w1 = np.random.normal()
    self.w2 = np.random.normal()
    self.w3 = np.random.normal()
    self.w4 = np.random.normal()
    self.w5 = np.random.normal()
    self.w6 = np.random.normal()

    # Biases
    self.b1 = np.random.normal()
    self.b2 = np.random.normal()
    self.b3 = np.random.normal()

  def feedforward(self, x):
    # x is a numpy array with 2 elements.
    h1 = sigmoid(self.w1 * x[0] + self.w2 * x[1] + self.b1)
    h2 = sigmoid(self.w3 * x[0] + self.w4 * x[1] + self.b2)
    o1 = sigmoid(self.w5 * h1 + self.w6 * h2 + self.b3)
    return o1

  def train(self, data, all_y_trues):
    &#39;&#39;&#39;
    - data is a (n x 2) numpy array, n = # of samples in the dataset.
    - all_y_trues is a numpy array with n elements.
      Elements in all_y_trues correspond to those in data.
    &#39;&#39;&#39;
    learn_rate = 0.1
    epochs = 1000 # number of times to loop through the entire dataset

    for epoch in range(epochs):
      for x, y_true in zip(data, all_y_trues):
        # --- Do a feedforward (we&#39;ll need these values later)
        sum_h1 = self.w1 * x[0] + self.w2 * x[1] + self.b1
        h1 = sigmoid(sum_h1)

        sum_h2 = self.w3 * x[0] + self.w4 * x[1] + self.b2
        h2 = sigmoid(sum_h2)

        sum_o1 = self.w5 * h1 + self.w6 * h2 + self.b3
        o1 = sigmoid(sum_o1)
        y_pred = o1

        # --- Calculate partial derivatives.
        # --- Naming: d_L_d_w1 represents &quot;partial L / partial w1&quot;
        d_L_d_ypred = -2 * (y_true - y_pred)

        # Neuron o1
        d_ypred_d_w5 = h1 * deriv_sigmoid(sum_o1)
        d_ypred_d_w6 = h2 * deriv_sigmoid(sum_o1)
        d_ypred_d_b3 = deriv_sigmoid(sum_o1)

        d_ypred_d_h1 = self.w5 * deriv_sigmoid(sum_o1)
        d_ypred_d_h2 = self.w6 * deriv_sigmoid(sum_o1)

        # Neuron h1
        d_h1_d_w1 = x[0] * deriv_sigmoid(sum_h1)
        d_h1_d_w2 = x[1] * deriv_sigmoid(sum_h1)
        d_h1_d_b1 = deriv_sigmoid(sum_h1)

        # Neuron h2
        d_h2_d_w3 = x[0] * deriv_sigmoid(sum_h2)
        d_h2_d_w4 = x[1] * deriv_sigmoid(sum_h2)
        d_h2_d_b2 = deriv_sigmoid(sum_h2)

        # --- Update weights and biases
        # Neuron h1
        self.w1 -= learn_rate * d_L_d_ypred * d_ypred_d_h1 * d_h1_d_w1
        self.w2 -= learn_rate * d_L_d_ypred * d_ypred_d_h1 * d_h1_d_w2
        self.b1 -= learn_rate * d_L_d_ypred * d_ypred_d_h1 * d_h1_d_b1

        # Neuron h2
        self.w3 -= learn_rate * d_L_d_ypred * d_ypred_d_h2 * d_h2_d_w3
        self.w4 -= learn_rate * d_L_d_ypred * d_ypred_d_h2 * d_h2_d_w4
        self.b2 -= learn_rate * d_L_d_ypred * d_ypred_d_h2 * d_h2_d_b2

        # Neuron o1
        self.w5 -= learn_rate * d_L_d_ypred * d_ypred_d_w5
        self.w6 -= learn_rate * d_L_d_ypred * d_ypred_d_w6
        self.b3 -= learn_rate * d_L_d_ypred * d_ypred_d_b3

      # --- Calculate total loss at the end of each epoch
      if epoch % 10 == 0:
        y_preds = np.apply_along_axis(self.feedforward, 1, data)
        loss = mse_loss(all_y_trues, y_preds)
        print(&quot;Epoch %d loss: %.3f&quot; % (epoch, loss))

# Define dataset
data = np.array([
  [-2, -1],  # Alice
  [25, 6],   # Bob
  [17, 4],   # Charlie
  [-15, -6], # Diana
])
all_y_trues = np.array([
  1, # Alice
  0, # Bob
  0, # Charlie
  1, # Diana
])

# Train our neural network!
network = OurNeuralNetwork()
network.train(data, all_y_trues)
</code></pre>
<blockquote>
<p>You can <a href="https://repl.it/@vzhou842/An-Introduction-to-Neural-Networks">run / play with this code yourself</a>. Itâ€™s also available on <a href="https://github.com/vzhou842/neural-network-from-scratch">Github</a>.</p>
</blockquote>
<p>éšç€ç½‘ç»œçš„å­¦ä¹ ï¼ŒæŸå¤±åœ¨ç¨³æ­¥ä¸‹é™ã€‚<br><img src="/.io//loss.webp" alt><br>ç°åœ¨æˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªç½‘ç»œæ¥é¢„æµ‹æ€§åˆ«äº†ï¼š</p>
<pre><code class="lang-py"># Make some predictions
emily = np.array([-7, -3]) # 128 pounds, 63 inches
frank = np.array([20, 2])  # 155 pounds, 68 inches
print(&quot;Emily: %.3f&quot; % network.feedforward(emily)) # 0.951 - F
print(&quot;Frank: %.3f&quot; % network.feedforward(frank)) # 0.039 - M
</code></pre>
<p>æ¥ä¸‹æ¥ï¼Ÿ<br>æå®šäº†ä¸€ä¸ªç®€å•çš„ç¥ç»ç½‘ç»œï¼Œå¿«é€Ÿå›é¡¾ä¸€ä¸‹ï¼š</p>
<ul>
<li>ä»‹ç»äº†ç¥ç»ç½‘ç»œçš„åŸºæœ¬ç»“æ„â€”â€”ç¥ç»å…ƒï¼›</li>
<li>åœ¨ç¥ç»å…ƒä¸­ä½¿ç”¨Så‹æ¿€æ´»å‡½æ•°ï¼›</li>
<li>ç¥ç»ç½‘ç»œå°±æ˜¯è¿æ¥åœ¨ä¸€èµ·çš„ç¥ç»å…ƒï¼›</li>
<li>æ„å»ºäº†ä¸€ä¸ªæ•°æ®é›†ï¼Œè¾“å…¥ï¼ˆæˆ–ç‰¹å¾ï¼‰æ˜¯ä½“é‡å’Œèº«é«˜ï¼Œè¾“å‡ºï¼ˆæˆ–æ ‡ç­¾ï¼‰æ˜¯æ€§åˆ«ï¼›</li>
<li>å­¦ä¹ äº†æŸå¤±å‡½æ•°å’Œå‡æ–¹å·®æŸå¤±ï¼›</li>
<li>è®­ç»ƒç½‘ç»œå°±æ˜¯æœ€å°åŒ–å…¶æŸå¤±ï¼›</li>
<li>ç”¨åå‘ä¼ æ’­æ–¹æ³•è®¡ç®—åå¯¼ï¼›</li>
<li>ç”¨éšæœºæ¢¯åº¦ä¸‹é™æ³•è®­ç»ƒç½‘ç»œï¼›</li>
</ul>
<p>æ¥ä¸‹æ¥ä½ è¿˜å¯ä»¥ï¼š<br><a href="https://victorzhou.com/blog/intro-to-neural-networks/">è·³è½¬åº•éƒ¨é“¾æ¥</a></p>
]]></content>
  </entry>
  <entry>
    <title>try</title>
    <url>/2023/06/04/try/</url>
    <content><![CDATA[<p><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script><br>åŸæ–‡å‡ºå¤„<a href="https://victorzhou.com/blog/intro-to-neural-networks/">Machine Learning for Beginners: An Introduction to Neural Networks</a></p>
<h4 id="ç –å—ï¼šç¥ç»å…ƒ"><a href="#ç –å—ï¼šç¥ç»å…ƒ" class="headerlink" title="ç –å—ï¼šç¥ç»å…ƒ"></a>ç –å—ï¼šç¥ç»å…ƒ</h4><p>ç¥ç»ç½‘ç»œçš„åŸºæœ¬å•ä½ï¼Œç¥ç»å…ƒã€‚ç¥ç»å…ƒæ¥å—è¾“å…¥ï¼Œå¯¹å…¶åšä¸€äº›æ•°æ®æ“ä½œï¼Œç„¶åäº§ç”Ÿè¾“å‡ºã€‚ä¾‹å¦‚ï¼Œè¿™æ˜¯ä¸€ä¸ª2-è¾“å…¥ç¥ç»å…ƒï¼š<br><img src="/.io//perceptron.svg" alt><br>è¿™é‡Œå‘ç”Ÿäº†ä¸‰ä¸ªäº‹æƒ…ã€‚é¦–å…ˆï¼Œæ¯ä¸ªè¾“å…¥éƒ½è·Ÿä¸€ä¸ªæƒé‡ç›¸ä¹˜ï¼ˆçº¢è‰²ï¼‰ï¼š</p>
<script type="math/tex; mode=display">
x_1â†’x_1*w_1 \\
x_2â†’x_2*w_2</script><p>ç„¶åï¼ŒåŠ æƒåçš„è¾“å…¥æ±‚å’Œï¼ŒåŠ ä¸Šä¸€ä¸ªåå·®bï¼ˆç»¿è‰²ï¼‰ï¼š</p>
<script type="math/tex; mode=display">
(x_1*w_1)+(x_2*w_2)+b</script><p>æœ€åï¼Œè¿™ä¸ªç»“æœä¼ é€’ç»™ä¸€ä¸ªæ¿€æ´»å‡½æ•°fï¼š</p>
<script type="math/tex; mode=display">
y=f(x_1*w_1+x_2*w_2+b)</script><p>æ¿€æ´»å‡½æ•°çš„ç”¨é€”æ˜¯å°†ä¸€ä¸ªæ— è¾¹ç•Œçš„è¾“å…¥ï¼Œè½¬å˜æˆä¸€ä¸ªå¯é¢„æµ‹çš„å½¢å¼ã€‚å¸¸ç”¨çš„æ¿€æ´»å‡½æ•°å°±å°±æ˜¯Så‹å‡½æ•°ï¼š<br><img src="/.io//sigmoid.webp" alt><br>Så‹å‡½æ•°çš„å€¼åŸŸæ˜¯$(0, 1)$ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯æŠŠ$(âˆ’âˆ, +âˆ)$å‹ç¼©åˆ°$(0, 1)$ ï¼Œå¾ˆå¤§çš„è´Ÿæ•°çº¦ç­‰äº$0$ï¼Œå¾ˆå¤§çš„æ­£æ•°çº¦ç­‰äº$1$ã€‚</p>
<h4 id="ä¸€ä¸ªç®€å•çš„ä¾‹å­"><a href="#ä¸€ä¸ªç®€å•çš„ä¾‹å­" class="headerlink" title="ä¸€ä¸ªç®€å•çš„ä¾‹å­"></a>ä¸€ä¸ªç®€å•çš„ä¾‹å­</h4><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª2-è¾“å…¥ç¥ç»å…ƒï¼Œæ¿€æ´»å‡½æ•°å°±æ˜¯Så‹å‡½æ•°ï¼Œå…¶å‚æ•°å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
w=[0,1] \\
b=4</script><p>$w=[0,1]$å°±æ˜¯ä»¥å‘é‡çš„å½¢å¼è¡¨ç¤º$w_1=0, w_2=1$ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬ç»™è¿™ä¸ªç¥ç»å…ƒä¸€ä¸ªè¾“å…¥$x=[2, 3]$ã€‚æˆ‘ä»¬ç”¨ç‚¹ç§¯æ¥è¡¨ç¤ºï¼š</p>
<p><img src="/.io//l1.png" alt></p>
<p>å½“è¾“å…¥æ˜¯[2, 3]æ—¶ï¼Œè¿™ä¸ªç¥ç»å…ƒçš„è¾“å‡ºæ˜¯0.999ã€‚ç»™å®šè¾“å…¥ï¼Œå¾—åˆ°è¾“å‡ºçš„è¿‡ç¨‹è¢«ç§°ä¸ºå‰é¦ˆï¼ˆfeedforwardï¼‰ã€‚</p>
<h4 id="ç¼–ç ä¸€ä¸ªç¥ç»å…ƒ"><a href="#ç¼–ç ä¸€ä¸ªç¥ç»å…ƒ" class="headerlink" title="ç¼–ç ä¸€ä¸ªç¥ç»å…ƒ"></a>ç¼–ç ä¸€ä¸ªç¥ç»å…ƒ</h4><p>è®©æˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªç¥ç»å…ƒï¼ç”¨Pythonçš„NumPyåº“æ¥å®Œæˆå…¶ä¸­çš„æ•°å­¦è®¡ç®—ï¼š</p>
<pre><code class="lang-py">import numpy as np

def sigmoid(x):
  # Our activation function: f(x) = 1 / (1 + e^(-x))
  return 1 / (1 + np.exp(-x))

class Neuron:
  def __init__(self, weights, bias):
    self.weights = weights
    self.bias = bias

  def feedforward(self, inputs):
    # Weight inputs, add bias, then use the activation function
    total = np.dot(self.weights, inputs) + self.bias
    return sigmoid(total)

weights = np.array([0, 1]) # w1 = 0, w2 = 1
bias = 4                   # b = 4
n = Neuron(weights, bias)

x = np.array([2, 3])       # x1 = 2, x2 = 3
print(n.feedforward(x))    # 0.9990889488055994
</code></pre>
<p>è¿˜è®°å¾—è¿™ä¸ªæ•°å­—å—ï¼Ÿå°±æ˜¯æˆ‘ä»¬å‰é¢ç®—å‡ºæ¥çš„ä¾‹å­ä¸­çš„0.999ã€‚</p>
<h3 id="æŠŠç¥ç»å…ƒç»„è£…æˆç½‘ç»œ"><a href="#æŠŠç¥ç»å…ƒç»„è£…æˆç½‘ç»œ" class="headerlink" title="æŠŠç¥ç»å…ƒç»„è£…æˆç½‘ç»œ"></a>æŠŠç¥ç»å…ƒç»„è£…æˆç½‘ç»œ</h3><p>æ‰€è°“çš„ç¥ç»ç½‘ç»œå°±æ˜¯ä¸€å †ç¥ç»å…ƒã€‚è¿™å°±æ˜¯ä¸€ä¸ªç®€å•çš„ç¥ç»ç½‘ç»œï¼š<br><img src="/.io//network.svg" alt><br>è¿™ä¸ªç½‘ç»œæœ‰ä¸¤ä¸ªè¾“å…¥ï¼Œä¸€ä¸ªæœ‰ä¸¤ä¸ªç¥ç»å…ƒï¼ˆ$h_1$å’Œ$h_2$ï¼‰çš„éšè—å±‚ï¼Œä»¥åŠä¸€ä¸ªæœ‰ä¸€ä¸ªç¥ç»å…ƒï¼ˆ$o_1$ï¼‰çš„è¾“å‡ºå±‚ã€‚è¦æ³¨æ„,$o_1$çš„è¾“å…¥å°±æ˜¯ $h_1$å’Œ $h_2$çš„è¾“å‡ºï¼Œè¿™æ ·å°±ç»„æˆäº†ä¸€ä¸ªç½‘ç»œã€‚</p>
<blockquote>
<p>éšè—å±‚å°±æ˜¯è¾“å…¥å±‚å’Œè¾“å‡ºå±‚ä¹‹é—´çš„å±‚ï¼Œéšè—å±‚å¯ä»¥æ˜¯å¤šå±‚çš„ã€‚</p>
</blockquote>
<h4 id="ä¾‹å­ï¼šå‰é¦ˆ"><a href="#ä¾‹å­ï¼šå‰é¦ˆ" class="headerlink" title="ä¾‹å­ï¼šå‰é¦ˆ"></a>ä¾‹å­ï¼šå‰é¦ˆ</h4><p>æˆ‘ä»¬ç»§ç»­ç”¨å‰é¢å›¾ä¸­çš„ç½‘ç»œï¼Œå‡è®¾æ¯ä¸ªç¥ç»å…ƒçš„æƒé‡éƒ½æ˜¯$w=[0,1]$ ï¼Œæˆªè·é¡¹ä¹Ÿç›¸åŒ $b=0$ï¼Œæ¿€æ´»å‡½æ•°ä¹Ÿéƒ½æ˜¯Så‹å‡½æ•°ã€‚åˆ†åˆ«ç”¨<br> $h_1,h_2,o_1$è¡¨ç¤ºç›¸åº”çš„ç¥ç»å…ƒçš„è¾“å‡ºã€‚</p>
<p>å½“è¾“å…¥$x=[2,3]$æ—¶ï¼Œä¼šå¾—åˆ°ä»€ä¹ˆç»“æœï¼Ÿ<br><img src="/.io//l2.png" alt><br>è¿™ä¸ªç¥ç»ç½‘ç»œå¯¹è¾“å…¥[2,3]çš„è¾“å‡ºæ˜¯0.7216ï¼Œå¾ˆç®€å•ã€‚</p>
<p>ä¸€ä¸ªç¥ç»ç½‘ç»œçš„å±‚æ•°ä»¥åŠæ¯ä¸€å±‚ä¸­çš„ç¥ç»å…ƒæ•°é‡éƒ½æ˜¯ä»»æ„çš„ã€‚åŸºæœ¬é€»è¾‘éƒ½ä¸€æ ·ï¼šè¾“å…¥åœ¨ç¥ç»ç½‘ç»œä¸­å‘å‰ä¼ è¾“ï¼Œæœ€ç»ˆå¾—åˆ°è¾“å‡ºã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¼šç»§ç»­ä½¿ç”¨å‰é¢çš„è¿™ä¸ªç½‘ç»œã€‚</p>
<h4 id="ç¼–ç ç¥ç»ç½‘ç»œï¼šå‰é¦ˆ"><a href="#ç¼–ç ç¥ç»ç½‘ç»œï¼šå‰é¦ˆ" class="headerlink" title="ç¼–ç ç¥ç»ç½‘ç»œï¼šå‰é¦ˆ"></a>ç¼–ç ç¥ç»ç½‘ç»œï¼šå‰é¦ˆ</h4><p>æ¥ä¸‹æ¥æˆ‘ä»¬å®ç°è¿™ä¸ªç¥ç»ç½‘ç»œçš„å‰é¦ˆæœºåˆ¶ï¼Œè¿˜æ˜¯è¿™ä¸ªå›¾ï¼š<br><img src="/.io//network%20(1" alt>.svg)</p>
<pre><code class="lang-py">import numpy as np

# ... code from previous section here

class OurNeuralNetwork:
  &#39;&#39;&#39;
  A neural network with:
    - 2 inputs
    - a hidden layer with 2 neurons (h1, h2)
    - an output layer with 1 neuron (o1)
  Each neuron has the same weights and bias:
    - w = [0, 1]
    - b = 0
  &#39;&#39;&#39;
  def __init__(self):
    weights = np.array([0, 1])
    bias = 0

    # The Neuron class here is from the previous section
    self.h1 = Neuron(weights, bias)
    self.h2 = Neuron(weights, bias)
    self.o1 = Neuron(weights, bias)

  def feedforward(self, x):
    out_h1 = self.h1.feedforward(x)
    out_h2 = self.h2.feedforward(x)

    # The inputs for o1 are the outputs from h1 and h2
    out_o1 = self.o1.feedforward(np.array([out_h1, out_h2]))

    return out_o1

network = OurNeuralNetwork()
x = np.array([2, 3])
print(network.feedforward(x)) # 0.7216325609518421
</code></pre>
<p>We got 0.7216 again! Looks like it works.</p>
<h3 id="è®­ç»ƒç¥ç»ç½‘ç»œï¼Œç¬¬1éƒ¨åˆ†"><a href="#è®­ç»ƒç¥ç»ç½‘ç»œï¼Œç¬¬1éƒ¨åˆ†" class="headerlink" title="è®­ç»ƒç¥ç»ç½‘ç»œï¼Œç¬¬1éƒ¨åˆ†"></a>è®­ç»ƒç¥ç»ç½‘ç»œï¼Œç¬¬1éƒ¨åˆ†</h3><p>ç°åœ¨æœ‰è¿™æ ·çš„æ•°æ®ï¼š<br>|Name     |Weight(lb)|    Height(in)    |Gender|<br>|  â€”â€”| â€”â€”  |â€”â€”|â€”â€”|<br>|Alice |133       |    65          |    F    |<br>|Bob     |160          |72             |M     |<br>|Charlie|    152|    70|    M|<br>|Diana    |120    |60    |F|<br>æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨è¿™ä¸ªæ•°æ®æ¥è®­ç»ƒç¥ç»ç½‘ç»œçš„æƒé‡å’Œæˆªè·é¡¹ï¼Œä»è€Œå¯ä»¥æ ¹æ®èº«é«˜ä½“é‡é¢„æµ‹æ€§åˆ«ï¼š<br><img src="/.io//network2.svg" alt><br>æˆ‘ä»¬ç”¨0å’Œ1åˆ†åˆ«è¡¨ç¤ºç”·æ€§ï¼ˆMï¼‰å’Œå¥³æ€§ï¼ˆFï¼‰ï¼Œå¹¶å¯¹æ•°å€¼åšäº†è½¬åŒ–ï¼š<br>|Name    |Weight(minus 135)    |Height(minus 66)    |Gender|<br>|  â€”â€”| â€”â€”  |â€”â€”|â€”â€”|<br>|Alice    |-2    |-1    |1|<br>|Bob    |25|    6    |0|<br>|Charlie|    17    |4|    0|<br>|Diana    |-15|    -6|    1|</p>
<blockquote>
<p>æˆ‘è¿™é‡Œæ˜¯éšæ„é€‰å–äº†135å’Œ66æ¥æ ‡å‡†åŒ–æ•°æ®ï¼Œé€šå¸¸ä¼šä½¿ç”¨å¹³å‡å€¼ã€‚</p>
</blockquote>
<h4 id="æŸå¤±"><a href="#æŸå¤±" class="headerlink" title="æŸå¤±"></a>æŸå¤±</h4><p>åœ¨è®­ç»ƒç½‘ç»œä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦é‡åŒ–å½“å‰çš„ç½‘ç»œæ˜¯ã€å¥½ã€è¿˜æ˜¯ã€åã€ï¼Œä»è€Œå¯ä»¥å¯»æ‰¾æ›´å¥½çš„ç½‘ç»œã€‚è¿™å°±æ˜¯å®šä¹‰<strong>æŸå¤±</strong>çš„ç›®çš„ã€‚</p>
<p>æˆ‘ä»¬åœ¨è¿™é‡Œç”¨å¹³å‡æ–¹å·®ï¼ˆMSEï¼‰æŸå¤±ï¼š<br>$MSE=\frac{1}{n}\sum_{i=1}^{n} (y_{true}-y_{pred})^2$<br> è®©æˆ‘ä»¬ä»”ç»†çœ‹çœ‹ï¼š</p>
<ul>
<li>næ˜¯æ ·å“æ•°ï¼Œè¿™é‡Œç­‰äº4ï¼ˆAliceã€Bobã€Charlieå’ŒDianaï¼‰ã€‚</li>
<li>yè¡¨ç¤ºè¦é¢„æµ‹çš„å˜é‡ï¼Œè¿™é‡Œæ˜¯æ€§åˆ«ã€‚</li>
<li>$y_{true}$ æ˜¯å˜é‡çš„çœŸå®å€¼ï¼ˆã€æ­£ç¡®ç­”æ¡ˆã€ï¼‰ã€‚ä¾‹å¦‚ï¼ŒAliceçš„$y_{true}$ å°±æ˜¯1ï¼ˆç”·æ€§ï¼‰ã€‚</li>
<li>$y_{pred}$ æ˜¯å˜é‡çš„é¢„æµ‹å€¼ã€‚è¿™å°±æ˜¯æˆ‘ä»¬ç½‘ç»œçš„è¾“å‡ºã€‚</li>
</ul>
<p>$(y_{true}-y_{pred})^2$è¢«ç§°ä¸ºæ–¹å·®ï¼ˆsquared errorï¼‰ã€‚æˆ‘ä»¬çš„æŸå¤±å‡½æ•°å°±æ˜¯æ‰€æœ‰æ–¹å·®çš„å¹³å‡å€¼ã€‚é¢„æµ‹æ•ˆæœäºæµ©ï¼ŒæŸå¤±å°±è¶Šå°‘ã€‚<br>æ›´å¥½çš„é¢„æµ‹ = æ›´å°‘çš„æŸå¤±ï¼<br>è®­ç»ƒç½‘ç»œ = æœ€å°åŒ–å®ƒçš„æŸå¤±ã€‚</p>
<h4 id="æŸå¤±è®¡ç®—ä¾‹å­"><a href="#æŸå¤±è®¡ç®—ä¾‹å­" class="headerlink" title="æŸå¤±è®¡ç®—ä¾‹å­"></a>æŸå¤±è®¡ç®—ä¾‹å­</h4><p>å‡è®¾æˆ‘ä»¬çš„ç½‘ç»œæ€»æ˜¯è¾“å‡º0ï¼Œæ¢è¨€ä¹‹å°±æ˜¯è®¤ä¸ºæ‰€æœ‰äººéƒ½æ˜¯ç”·æ€§ã€‚æŸå¤±å¦‚ä½•ï¼ŸğŸ¤”<br><img src="/.io//l3.png" alt></p>
<h4 id="ä»£ç ï¼šMSEæŸå¤±"><a href="#ä»£ç ï¼šMSEæŸå¤±" class="headerlink" title="ä»£ç ï¼šMSEæŸå¤±"></a>ä»£ç ï¼šMSEæŸå¤±</h4><p>ä¸‹é¢æ˜¯è®¡ç®—MSEæŸå¤±çš„ä»£ç ï¼š</p>
<pre><code class="lang-py">import numpy as np

def mse_loss(y_true, y_pred):
  # y_true and y_pred are numpy arrays of the same length.
  return ((y_true - y_pred) ** 2).mean()

y_true = np.array([1, 0, 0, 1])
y_pred = np.array([0, 0, 0, 0])

print(mse_loss(y_true, y_pred)) # 0.5
</code></pre>
<blockquote>
<p>å¦‚æœä½ ä¸ç†è§£è¿™æ®µä»£ç ï¼Œå¯ä»¥çœ‹çœ‹NumPyçš„<a href="https://numpy.org/doc/stable/user/quickstart.html#basic-operations">å¿«é€Ÿå…¥é—¨</a>ä¸­å…³äºæ•°ç»„çš„æ“ä½œã€‚</p>
</blockquote>
<p>Nice. Onwards!</p>
<h3 id="è®­ç»ƒç¥ç»ç½‘ç»œï¼Œç¬¬2éƒ¨åˆ†"><a href="#è®­ç»ƒç¥ç»ç½‘ç»œï¼Œç¬¬2éƒ¨åˆ†" class="headerlink" title="è®­ç»ƒç¥ç»ç½‘ç»œï¼Œç¬¬2éƒ¨åˆ†"></a>è®­ç»ƒç¥ç»ç½‘ç»œï¼Œç¬¬2éƒ¨åˆ†</h3><p>ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªæ˜ç¡®çš„ç›®æ ‡ï¼šæœ€å°åŒ–ç¥ç»ç½‘ç»œçš„æŸå¤±ã€‚é€šè¿‡è°ƒæ•´ç½‘ç»œçš„æƒé‡å’Œæˆªè·é¡¹ï¼Œæˆ‘ä»¬å¯ä»¥æ”¹å˜å…¶é¢„æµ‹ç»“æœï¼Œä½†å¦‚ä½•æ‰èƒ½é€æ­¥åœ°å‡å°‘æŸå¤±ï¼Ÿ</p>
<blockquote>
<p>è¿™ä¸€æ®µå†…å®¹æ¶‰åŠåˆ°å¤šå…ƒå¾®ç§¯åˆ†ï¼Œå¦‚æœä¸ç†Ÿæ‚‰å¾®ç§¯åˆ†çš„è¯ï¼Œå¯ä»¥è·³è¿‡è¿™äº›æ•°å­¦å†…å®¹ã€‚</p>
</blockquote>
<p>ä¸ºäº†ç®€åŒ–é—®é¢˜ï¼Œå‡è®¾æˆ‘ä»¬çš„æ•°æ®é›†ä¸­åªæœ‰Aliceï¼š<br>|Name    |Weight(minus 135)    |Height(minus 66)    |Gender|<br>|  â€”â€”| â€”â€”  |â€”â€”|â€”â€”|<br>|Alice    |-2    |-1|    1|<br>|Name    |$y_{true}$    |$y_{pred}$    |$(y_{true}-y_{pred})^2$|<br>|Alice    |1    |0|    1|</p>
<p>é‚£å‡æ–¹å·®æŸå¤±å°±åªæ˜¯Aliceçš„æ–¹å·®ï¼š<br>$MSE=\frac{1}{1}\sum_{i=1}^{1} (y_{true}-y_{pred})^2 \\<br>\quad \quad= (y_{true}-y_{pred})^2 \\<br>\quad \quad= (1-y_{pred})^2$<br>ä¹Ÿå¯ä»¥æŠŠæŸå¤±çœ‹æˆæ˜¯æƒé‡å’Œæˆªè·é¡¹çš„å‡½æ•°ã€‚è®©æˆ‘ä»¬ç»™ç½‘ç»œæ ‡ä¸Šæƒé‡å’Œæˆªè·é¡¹ï¼š<br><img src="/.io//network3%20(1" alt>.svg)<br>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æŠŠç½‘ç»œçš„æŸå¤±è¡¨ç¤ºä¸ºï¼š</p>
<script type="math/tex; mode=display">L(w_1,w_2,w_3,w_4,w_5,w_6,b_1,b_2,b_3)</script><p>å‡è®¾æˆ‘ä»¬è¦ä¼˜åŒ– $w_1$ï¼Œå½“æˆ‘ä»¬æ”¹å˜$w_1$æ—¶ï¼ŒæŸå¤± $L$ ä¼šæ€ä¹ˆå˜åŒ–ï¼Ÿå¯ä»¥ç”¨ $ \frac{\partial L}{\partial w_1}$æ¥å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæ€ä¹ˆè®¡ç®—ï¼Ÿ</p>
<blockquote>
<p>æ¥ä¸‹æ¥çš„æ•°æ®ç¨å¾®æœ‰ç‚¹å¤æ‚ï¼Œåˆ«æ‹…å¿ƒï¼Œå‡†å¤‡å¥½çº¸å’Œç¬”ã€‚</p>
</blockquote>
<p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬ç”¨ $ \frac{\partial y_{pred}}{\partial w_1}$æ¥æ”¹å†™è¿™ä¸ªåå¯¼æ•°ï¼š<br><img src="/.io//l4.png" alt><br><img src="/.io//l5.png" alt><br>è¿™ç§è®¡ç®—åå¯¼çš„æ–¹æ³•å«ã€åå‘ä¼ æ’­ç®—æ³•ã€(backpropagation)ã€‚</p>
<p>å¥½å¤šæ•°å­¦ç¬¦å·ï¼Œå¦‚æœä½ è¿˜æ²¡ææ˜ç™½çš„è¯ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå®é™…ä¾‹å­ã€‚</p>
<h4 id="ä¾‹å­ï¼šè®¡ç®—åå¯¼æ•°"><a href="#ä¾‹å­ï¼šè®¡ç®—åå¯¼æ•°" class="headerlink" title="ä¾‹å­ï¼šè®¡ç®—åå¯¼æ•°"></a>ä¾‹å­ï¼šè®¡ç®—åå¯¼æ•°</h4><p>æˆ‘ä»¬è¿˜æ˜¯çœ‹æ•°æ®é›†ä¸­åªæœ‰Aliceçš„æƒ…å†µ:<br>|Name    |Weight(minus 135)    |Height(minus 66)    |Gender|<br>|  â€”â€”| â€”â€”  |â€”â€”|â€”â€”|<br>|Alice    |-2    |-1|    1|<br>|Name    |$y_{true}$    |$y_{pred}$    |$(y_{true}-y_{pred})^2$|<br>|Alice    |1    |0|    1|<br>æŠŠæ‰€æœ‰çš„æƒé‡å’Œæˆªè·é¡¹éƒ½åˆ†åˆ«åˆå§‹åŒ–ä¸º1å’Œ0ã€‚åœ¨ç½‘ç»œä¸­åšå‰é¦ˆè®¡ç®—ï¼š<br><img src="/.io//l6.png" alt><br><img src="/.io//l7.png" alt></p>
<h4 id="è®­ç»ƒï¼šéšæœºæ¢¯åº¦ä¸‹é™"><a href="#è®­ç»ƒï¼šéšæœºæ¢¯åº¦ä¸‹é™" class="headerlink" title="è®­ç»ƒï¼šéšæœºæ¢¯åº¦ä¸‹é™"></a>è®­ç»ƒï¼šéšæœºæ¢¯åº¦ä¸‹é™</h4><p>ç°åœ¨è®­ç»ƒç¥ç»ç½‘ç»œå·²ç»ä¸‡äº‹ä¿±å¤‡äº†ï¼æˆ‘ä»¬ä¼šä½¿ç”¨åä¸ºéšæœºæ¢¯åº¦ä¸‹é™æ³•çš„ä¼˜åŒ–ç®—æ³•æ¥ä¼˜åŒ–ç½‘ç»œçš„æƒé‡å’Œæˆªè·é¡¹ï¼Œå®ç°æŸå¤±çš„æœ€å°åŒ–ã€‚æ ¸å¿ƒå°±æ˜¯è¿™ä¸ªæ›´æ–°ç­‰å¼ï¼š</p>
<script type="math/tex; mode=display">w_1â†w_1-Î·\frac{\partial L}{\partial w_1}</script><p> Î·æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œè¢«ç§°ä¸ºå­¦ä¹ ç‡ï¼Œç”¨äºè°ƒæ•´è®­ç»ƒçš„é€Ÿåº¦ã€‚æˆ‘ä»¬è¦åšçš„å°±æ˜¯ç”¨$w_1$ å‡å»$Î·\frac{\partial L}{\partial w_1}$ ï¼š</p>
<ul>
<li>å¦‚æœ $\frac{\partial L}{\partial w_1}$æ˜¯æ­£æ•°ï¼Œ$w_1$ ä¼šå˜å°ï¼Œ$L$ ä¼šä¸‹é™ã€‚</li>
<li>å¦‚æœ $\frac{\partial L}{\partial w_1}$æ˜¯è´Ÿæ•°ï¼Œ$w_1$ ä¼šå˜å¤§ï¼Œ$L$ ä¼šä¸‹é™ã€‚<br>å¦‚æœæˆ‘ä»¬å¯¹ç½‘ç»œä¸­çš„æ¯ä¸ªæƒé‡å’Œæˆªè·é¡¹éƒ½è¿™æ ·è¿›è¡Œä¼˜åŒ–ï¼ŒæŸå¤±å°±ä¼šä¸æ–­ä¸‹é™ï¼Œç½‘ç»œæ€§èƒ½ä¼šä¸æ–­ä¸Šå‡ã€‚</li>
</ul>
<p>æˆ‘ä»¬çš„è®­ç»ƒè¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼š</p>
<ol>
<li>ä»æˆ‘ä»¬çš„æ•°æ®é›†ä¸­é€‰æ‹©ä¸€ä¸ªæ ·æœ¬ï¼Œç”¨éšæœºæ¢¯åº¦ä¸‹é™æ³•è¿›è¡Œä¼˜åŒ–â€”â€”æ¯æ¬¡æˆ‘ä»¬éƒ½åªé’ˆå¯¹ä¸€ä¸ªæ ·æœ¬è¿›è¡Œä¼˜åŒ–ï¼› </li>
<li>è®¡ç®—æ¯ä¸ªæƒé‡æˆ–æˆªè·é¡¹å¯¹æŸå¤±çš„åå¯¼ï¼ˆä¾‹å¦‚ $\frac{\partial L}{\partial w_1}$ ã€ $\frac{\partial L}{\partial w_2}$ ç­‰ï¼‰ï¼› </li>
<li>ç”¨æ›´æ–°ç­‰å¼æ›´æ–°æ¯ä¸ªæƒé‡å’Œæˆªè·é¡¹ï¼› </li>
<li>é‡å¤ç¬¬ä¸€æ­¥ï¼›</li>
</ol>
<h3 id="ä»£ç ï¼šä¸€ä¸ªå®Œæ•´çš„ç¥ç»ç½‘ç»œ"><a href="#ä»£ç ï¼šä¸€ä¸ªå®Œæ•´çš„ç¥ç»ç½‘ç»œ" class="headerlink" title="ä»£ç ï¼šä¸€ä¸ªå®Œæ•´çš„ç¥ç»ç½‘ç»œ"></a>ä»£ç ï¼šä¸€ä¸ªå®Œæ•´çš„ç¥ç»ç½‘ç»œ</h3><p>æˆ‘ä»¬ç»ˆäºå¯ä»¥å®ç°ä¸€ä¸ªå®Œæ•´çš„ç¥ç»ç½‘ç»œäº†ï¼š<br>|Name    |Weight(minus 135)    |Height(minus 66)    |Gender|<br>|  â€”â€”| â€”â€”  |â€”â€”|â€”â€”|<br>|Alice    |-2    |-1    |1|<br>|Bob    |25|    6    |0|<br>|Charlie|    17    |4|    0|<br>|Diana    |-15|    -6|    1|<br><img src="/.io//network3%20(1" alt>.svg)</p>
<pre><code class="lang-py">import numpy as np

def sigmoid(x):
  # Sigmoid activation function: f(x) = 1 / (1 + e^(-x))
  return 1 / (1 + np.exp(-x))

def deriv_sigmoid(x):
  # Derivative of sigmoid: f&#39;(x) = f(x) * (1 - f(x))
  fx = sigmoid(x)
  return fx * (1 - fx)

def mse_loss(y_true, y_pred):
  # y_true and y_pred are numpy arrays of the same length.
  return ((y_true - y_pred) ** 2).mean()

class OurNeuralNetwork:
  &#39;&#39;&#39;
  A neural network with:
    - 2 inputs
    - a hidden layer with 2 neurons (h1, h2)
    - an output layer with 1 neuron (o1)

  *** DISCLAIMER ***:
  The code below is intended to be simple and educational, NOT optimal.
  Real neural net code looks nothing like this. DO NOT use this code.
  Instead, read/run it to understand how this specific network works.
  &#39;&#39;&#39;
  def __init__(self):
    # Weights
    self.w1 = np.random.normal()
    self.w2 = np.random.normal()
    self.w3 = np.random.normal()
    self.w4 = np.random.normal()
    self.w5 = np.random.normal()
    self.w6 = np.random.normal()

    # Biases
    self.b1 = np.random.normal()
    self.b2 = np.random.normal()
    self.b3 = np.random.normal()

  def feedforward(self, x):
    # x is a numpy array with 2 elements.
    h1 = sigmoid(self.w1 * x[0] + self.w2 * x[1] + self.b1)
    h2 = sigmoid(self.w3 * x[0] + self.w4 * x[1] + self.b2)
    o1 = sigmoid(self.w5 * h1 + self.w6 * h2 + self.b3)
    return o1

  def train(self, data, all_y_trues):
    &#39;&#39;&#39;
    - data is a (n x 2) numpy array, n = # of samples in the dataset.
    - all_y_trues is a numpy array with n elements.
      Elements in all_y_trues correspond to those in data.
    &#39;&#39;&#39;
    learn_rate = 0.1
    epochs = 1000 # number of times to loop through the entire dataset

    for epoch in range(epochs):
      for x, y_true in zip(data, all_y_trues):
        # --- Do a feedforward (we&#39;ll need these values later)
        sum_h1 = self.w1 * x[0] + self.w2 * x[1] + self.b1
        h1 = sigmoid(sum_h1)

        sum_h2 = self.w3 * x[0] + self.w4 * x[1] + self.b2
        h2 = sigmoid(sum_h2)

        sum_o1 = self.w5 * h1 + self.w6 * h2 + self.b3
        o1 = sigmoid(sum_o1)
        y_pred = o1

        # --- Calculate partial derivatives.
        # --- Naming: d_L_d_w1 represents &quot;partial L / partial w1&quot;
        d_L_d_ypred = -2 * (y_true - y_pred)

        # Neuron o1
        d_ypred_d_w5 = h1 * deriv_sigmoid(sum_o1)
        d_ypred_d_w6 = h2 * deriv_sigmoid(sum_o1)
        d_ypred_d_b3 = deriv_sigmoid(sum_o1)

        d_ypred_d_h1 = self.w5 * deriv_sigmoid(sum_o1)
        d_ypred_d_h2 = self.w6 * deriv_sigmoid(sum_o1)

        # Neuron h1
        d_h1_d_w1 = x[0] * deriv_sigmoid(sum_h1)
        d_h1_d_w2 = x[1] * deriv_sigmoid(sum_h1)
        d_h1_d_b1 = deriv_sigmoid(sum_h1)

        # Neuron h2
        d_h2_d_w3 = x[0] * deriv_sigmoid(sum_h2)
        d_h2_d_w4 = x[1] * deriv_sigmoid(sum_h2)
        d_h2_d_b2 = deriv_sigmoid(sum_h2)

        # --- Update weights and biases
        # Neuron h1
        self.w1 -= learn_rate * d_L_d_ypred * d_ypred_d_h1 * d_h1_d_w1
        self.w2 -= learn_rate * d_L_d_ypred * d_ypred_d_h1 * d_h1_d_w2
        self.b1 -= learn_rate * d_L_d_ypred * d_ypred_d_h1 * d_h1_d_b1

        # Neuron h2
        self.w3 -= learn_rate * d_L_d_ypred * d_ypred_d_h2 * d_h2_d_w3
        self.w4 -= learn_rate * d_L_d_ypred * d_ypred_d_h2 * d_h2_d_w4
        self.b2 -= learn_rate * d_L_d_ypred * d_ypred_d_h2 * d_h2_d_b2

        # Neuron o1
        self.w5 -= learn_rate * d_L_d_ypred * d_ypred_d_w5
        self.w6 -= learn_rate * d_L_d_ypred * d_ypred_d_w6
        self.b3 -= learn_rate * d_L_d_ypred * d_ypred_d_b3

      # --- Calculate total loss at the end of each epoch
      if epoch % 10 == 0:
        y_preds = np.apply_along_axis(self.feedforward, 1, data)
        loss = mse_loss(all_y_trues, y_preds)
        print(&quot;Epoch %d loss: %.3f&quot; % (epoch, loss))

# Define dataset
data = np.array([
  [-2, -1],  # Alice
  [25, 6],   # Bob
  [17, 4],   # Charlie
  [-15, -6], # Diana
])
all_y_trues = np.array([
  1, # Alice
  0, # Bob
  0, # Charlie
  1, # Diana
])

# Train our neural network!
network = OurNeuralNetwork()
network.train(data, all_y_trues)
</code></pre>
<blockquote>
<p>You can <a href="https://repl.it/@vzhou842/An-Introduction-to-Neural-Networks">run / play with this code yourself</a>. Itâ€™s also available on <a href="https://github.com/vzhou842/neural-network-from-scratch">Github</a>.</p>
</blockquote>
<p>éšç€ç½‘ç»œçš„å­¦ä¹ ï¼ŒæŸå¤±åœ¨ç¨³æ­¥ä¸‹é™ã€‚<br><img src="/.io//loss.webp" alt><br>ç°åœ¨æˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªç½‘ç»œæ¥é¢„æµ‹æ€§åˆ«äº†ï¼š</p>
<pre><code class="lang-py"># Make some predictions
emily = np.array([-7, -3]) # 128 pounds, 63 inches
frank = np.array([20, 2])  # 155 pounds, 68 inches
print(&quot;Emily: %.3f&quot; % network.feedforward(emily)) # 0.951 - F
print(&quot;Frank: %.3f&quot; % network.feedforward(frank)) # 0.039 - M
</code></pre>
<p>æ¥ä¸‹æ¥ï¼Ÿ<br>æå®šäº†ä¸€ä¸ªç®€å•çš„ç¥ç»ç½‘ç»œï¼Œå¿«é€Ÿå›é¡¾ä¸€ä¸‹ï¼š</p>
<ul>
<li>ä»‹ç»äº†ç¥ç»ç½‘ç»œçš„åŸºæœ¬ç»“æ„â€”â€”ç¥ç»å…ƒï¼›</li>
<li>åœ¨ç¥ç»å…ƒä¸­ä½¿ç”¨Så‹æ¿€æ´»å‡½æ•°ï¼›</li>
<li>ç¥ç»ç½‘ç»œå°±æ˜¯è¿æ¥åœ¨ä¸€èµ·çš„ç¥ç»å…ƒï¼›</li>
<li>æ„å»ºäº†ä¸€ä¸ªæ•°æ®é›†ï¼Œè¾“å…¥ï¼ˆæˆ–ç‰¹å¾ï¼‰æ˜¯ä½“é‡å’Œèº«é«˜ï¼Œè¾“å‡ºï¼ˆæˆ–æ ‡ç­¾ï¼‰æ˜¯æ€§åˆ«ï¼›</li>
<li>å­¦ä¹ äº†æŸå¤±å‡½æ•°å’Œå‡æ–¹å·®æŸå¤±ï¼›</li>
<li>è®­ç»ƒç½‘ç»œå°±æ˜¯æœ€å°åŒ–å…¶æŸå¤±ï¼›</li>
<li>ç”¨åå‘ä¼ æ’­æ–¹æ³•è®¡ç®—åå¯¼ï¼›</li>
<li>ç”¨éšæœºæ¢¯åº¦ä¸‹é™æ³•è®­ç»ƒç½‘ç»œï¼›</li>
</ul>
<p>æ¥ä¸‹æ¥ä½ è¿˜å¯ä»¥ï¼š<br><a href="https://victorzhou.com/blog/intro-to-neural-networks/">è·³è½¬åº•éƒ¨é“¾æ¥</a></p>
]]></content>
  </entry>
</search>
